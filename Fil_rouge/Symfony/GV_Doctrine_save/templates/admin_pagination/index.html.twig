{% extends 'base.html.twig' %}

{% block title %}
	{{ parent() }}Administration des commandes
{% endblock %}

{% block body %}

	<div class="header-title color-fond2 font-title">
		<h1>Gestion des commandes</h1>
	</div>

	<form method="get" class="mb-6 flex flex-col sm:flex-col items-center gap-4">
		<label for="statu" class="text-sm font-medium text-gray-700">Filtrer par statut :</label>
		<select name="statu" id="statu" onchange="this.form.submit()" class="rounded-[16px] text-center border-none text-[12pt] w-full max-w-[300px] h-[30px] cursor-pointer bg-[#62626269] backdrop-blur-[2.2px] font-title">
			<option value="">-- Tous --</option>
			{% for value in ['en_attente', 'en_préparation', 'expédiée', 'livrée'] %}
				<option value="{{ value }}" {% if statu == value %} selected {% endif %}>
					{{ value|capitalize }}
				</option>
			{% endfor %}
		</select>
	</form>

	<h1 class="text-2xl font-bold mb-4 text-center">Liste des commandes</h1>

	<table class="table-auto border-collapse w-full max-w-6xl mx-auto text-sm text-left text-gray-700">
		<thead>
			<tr>
				<th class="border border-slate-400 px-4 py-2 bg-gray-100 font-medium font-title text-base">ID</th>
				<th class="border border-slate-400 px-4 py-2 bg-gray-100 font-medium font-title text-base">Client</th>
				<th class="border border-slate-400 px-4 py-2 bg-gray-100 font-medium font-title text-base">Date</th>
				<th class="border border-slate-400 px-4 py-2 bg-gray-100 font-medium font-title text-base">Statut</th>
				<th class="border border-slate-400 px-4 py-2 bg-gray-100 font-medium font-title text-base text-center">Détails</th>
			</tr>
		</thead>
		<tbody class="bg-white">
			{% for commande in pagination %}
				<tr class="hover:bg-gray-50 transition">
					<td class="border border-slate-400 px-4 py-2">{{ commande.id }}</td>
					<td class="border border-slate-400 px-4 py-2">{{ commande.client.nom }}</td>
					<td class="border border-slate-400 px-4 py-2">{{ commande.dateCommande|date('d/m/Y') }}</td>
					<td class="border border-slate-400 px-4 py-2">{{ commande.statu }}</td>
					<td class="border border-slate-400 px-4 py-2 text-center">
						<a href="{{ path('app_admin_commande', {'id': commande.id}) }}" class="inline-flex items-center gap-2 bg-[#369354] no-underline text-white font-semibold px-5 py-2 rounded-2xl shadow-md hover:shadow-lg hover:brightness-110 transition-all duration-300">Détail</a>
					</td>
				</tr>
			{% else %}
				<tr>
					<td colspan="4" class="border border-slate-400 px-4 py-4 text-center text-gray-500">
						Aucune commande trouvée.
					</td>
				</tr>
			{% endfor %}
		</tbody>
	</table>

	<div class="mt-6 flex justify-center">
		<nav class="inline-flex space-x-1 text-sm">
			{% if pagination.currentPageNumber > 1 %}
				<a href="{{ path(app.request.attributes.get('_route'), app.request.query.all | merge({'page': pagination.currentPageNumber - 1})) }}" class="px-3 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300">Précédent</a>
			{% endif %}

			{% for page in 1..pagination.pageCount %}
				{% if page == pagination.currentPageNumber %}
					<span class="px-3 py-1 color-btnCta text-white rounded">{{ page }}</span>
				{% else %}
					<a href="{{ path(app.request.attributes.get('_route'), app.request.query.all | merge({'page': page})) }}" class="px-3 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300">{{ page }}</a>
				{% endif %}
			{% endfor %}

			{% if pagination.currentPageNumber < pagination.pageCount %}
				<a href="{{ path(app.request.attributes.get('_route'), app.request.query.all | merge({'page': pagination.currentPageNumber + 1})) }}" class="px-3 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300">Suivant</a>
			{% endif %}
		</nav>
	</div>

	<div class="flex flex-wrap justify-evenly mt-[20px]">
		<a class="app-button color-btnCta" href="{{path('app_admin')}}">Revenir à la page de gestion</a>
	</div>


{% endblock %}
